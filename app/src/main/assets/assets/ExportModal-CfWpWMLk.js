import{j as e,C as j}from"./index-Qv1PFdT_.js";import{u as m}from"./useCopyToClipboard-EhHpMIYG.js";const C=({session:r,onClose:c})=>{var h;const{topic:g}=r,[u,f]=m(),[k,v]=m(),b=typeof((h=window.AndroidBridge)==null?void 0:h.saveFile)=="function",l=()=>!r.turnOrder||!r.turns?"No conversation data available.":r.turnOrder.map(t=>r.turns[t]).filter(Boolean).map(t=>`[${t.role.toUpperCase()}]
${t.content}`).join(`

---

`),i=()=>JSON.stringify(r,null,2),n=t=>{const o=(g||"Untitled Session").replace(/[^a-z0-9]/gi,"_").toLowerCase(),a=new Date().toISOString().split("T")[0];return`socratic_tutor_${o}_${a}.${t}`},p=(t,o,a)=>{try{const s=new Blob([t],{type:a}),x=URL.createObjectURL(s),d=document.createElement("a");d.href=x,d.download=o,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(x)}catch(s){console.error("File download failed:",s),alert("Could not download the file. Your browser may not support this feature.")}},y=()=>{if(!b)return;const t=n("json"),o=i();try{window.AndroidBridge.saveFile(t,"application/json",o)}catch(a){console.error("Failed to save file via Android Bridge:",a),alert("Failed to save file. Please check app permissions.")}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-start pt-12 p-4",children:e.jsxs("div",{className:"bg-light-surface dark:bg-dark-surface rounded-lg shadow-custom-lg-light dark:shadow-custom-lg-dark w-full max-w-lg border border-light-border dark:border-dark-border animate-scale-in",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-light-border dark:border-dark-border",children:[e.jsx("h2",{className:"text-xl font-bold font-display",children:"Export Conversation"}),e.jsx("button",{onClick:c,className:"p-2 rounded-full hover:bg-black/10 dark:hover:bg-white/10",children:e.jsx(j,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Text Format"}),e.jsx("textarea",{readOnly:!0,value:l(),className:"w-full h-32 p-2 border rounded bg-light-bg dark:bg-dark-bg border-light-border dark:border-dark-border"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>f(l()),className:"px-3 py-1 text-sm bg-light-primary text-white rounded-md hover:opacity-90 transition-opacity",children:u?"Copied!":"Copy to Clipboard"}),e.jsx("button",{onClick:()=>p(l(),n("txt"),"text/plain"),className:"px-3 py-1 text-sm bg-light-accent text-white rounded-md hover:opacity-90 transition-opacity",children:"Download File"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"JSON Format"}),e.jsx("textarea",{readOnly:!0,value:i(),className:"w-full h-32 p-2 border rounded bg-light-bg dark:bg-dark-bg border-light-border dark:border-dark-border"}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>v(i()),className:"px-3 py-1 text-sm bg-light-primary text-white rounded-md hover:opacity-90 transition-opacity",children:k?"Copied!":"Copy to Clipboard"}),e.jsx("button",{onClick:()=>p(i(),n("json"),"application/json"),className:"px-3 py-1 text-sm bg-light-accent text-white rounded-md hover:opacity-90 transition-opacity",children:"Download File"})]})]}),b&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Save to Device (Android)"}),e.jsx("p",{className:"text-xs text-light-text-secondary dark:text-dark-text-secondary mb-2",children:"Saves the conversation as a JSON file to your device's downloads folder."}),e.jsx("button",{onClick:y,className:"w-full px-3 py-2 text-sm text-white rounded-md bg-green-700 hover:bg-green-600 transition-all",children:"Save JSON via Android"})]})]}),e.jsx("div",{className:"p-4 flex justify-end bg-light-bg dark:bg-dark-bg rounded-b-lg",children:e.jsx("button",{onClick:c,className:"px-4 py-2 bg-light-surface dark:bg-dark-surface border border-light-border dark:border-dark-border text-light-text dark:text-dark-text rounded-lg hover:bg-light-border dark:hover:bg-dark-border transition-colors",children:"Close"})})]})})};export{C as default};
